require('common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/family/foodIndex"],{"0850":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{type:"",searchHistory:[],keyword:"",rows:20,page:1,allLoaded:!1,list:[],loadMoreStatus:"loadmore",showPopup:!1,caipId:"",foodImg:"",foodName:"",foodUnit:"",foodNum:100,heatQuantity:0,startTime1:"",startTime2:"",endTime1:"",endTime2:"",minusInterval:null,addInterval:null}},computed:{sessionId:function(){return this.$store.state.app.sessionId},memberId:function(){return this.$store.state.member.memberId}},onLoad:function(t){t&&(this.type=t.type,this.date=t.date)},onShow:function(){this.getHistory()},onHide:function(){clearInterval(this.minusInterval),clearInterval(this.addInterval)},onUnload:function(){clearInterval(this.minusInterval),clearInterval(this.addInterval)},onReachBottom:function(){if(this.allLoaded)return!1;console.log("allLoaded值为："+this.allLoaded),this.loadMoreStatus="loading",this.page++,this.searchFood("@cxx@")},methods:{getHistory:function(){var t=this,e={sessionId:this.sessionId};this.$http.get("/mobile/bite/getFoodHistory",e).then((function(e){e.data.success&&(t.searchHistory=e.data.obj)}))},search:function(t){this.keyword=t,this.page=1,this.searchFood()},searchFood:function(t){var e=this;console.log(t),"@cxx@"!==t&&(this.page=1);var o={name:this.keyword,sessionId:this.sessionId,page:this.page,rows:this.rows};this.$http.get("/mobile/bite/getFoodName",o).then((function(o){if(o.data.success){var n=o.data.rows;n.forEach((function(t){[3,6,7].includes(t.foodUnitType)?e.$set(t,"foodUnit","ml"):e.$set(t,"foodUnit","g")}));var i=o.data.pager;e.allLoaded=i.currentPage===i.totalPages,e.loadMoreStatus=e.allLoaded?"nomore":"loading",e.list="@cxx@"===t?e.list.concat(n):n;var a=!0;e.searchHistory.forEach((function(t){t.foodName===e.keyword&&(a=!1)})),1===e.page&&a&&e.addHistory()}}))},addHistory:function(){var t=this,e={name:this.keyword,sessionId:this.sessionId};this.$http.post("/mobile/bite/addFoodHistory",e).then((function(e){e.data.success&&t.getHistory()}))},toDetail:function(e){var o=e.caipId,n=(e.foodNum,e.foodUnit),i=this.date,a=this.type;t.navigateTo({url:"./foodDetails?caipId=".concat(o,"&foodUnit=").concat(n,"&biteTime=").concat(i,"&foodType=").concat(a)})},addBite:function(t){for(var e in console.log(t),t)this[e]=t[e];this.showPopup=!0},minusStart:function(t){var e=this;console.log(t),this.endTime1="",this.startTime1=t.timeStamp,clearInterval(this.minusInterval),this.minusInterval=null,setTimeout((function(){console.log(e.startTime1),e.endTime1?(clearInterval(e.minusInterval),console.log("short"),console.log(e.foodNum),e.foodNum>1&&(console.log("fit"),e.foodNum--)):(clearInterval(e.minusInterval),e.minusInterval=setInterval((function(){e.foodNum>1&&(console.log("fit"),e.foodNum--)}),50))}),300)},addStart:function(t){var e=this;console.log(t),this.endTime2="",this.startTime2=t.timeStamp,clearInterval(this.addInterval),this.addInterval=null,setTimeout((function(){e.endTime2?(clearInterval(e.addInterval),console.log("short"),console.log(e.foodNum),e.foodNum<999&&(console.log("fit"),e.foodNum++)):(clearInterval(e.addInterval),e.addInterval=setInterval((function(){e.foodNum<999&&(console.log("fit"),e.foodNum++)}),50))}),300)},minusEnd:function(t){console.log("minusEnd"),clearInterval(this.minusInterval),this.endTime1=t.timeStamp},addEnd:function(t){console.log("addEnd"),clearInterval(this.addInterval),this.endTime2=t.timeStamp},touchMove:function(t){console.log("moved"),clearInterval(this.minusInterval),clearInterval(this.addInterval)},addCertain:function(){var e=this,o={sessionId:this.sessionId,memberId:this.memberId,biteTime:this.date,foodType:this.type,foodName:this.foodName,foodImg:this.foodImg,foodNum:this.foodNum,foodUnit:this.foodUnit,caipId:this.caipId,heatQuantity:this.heatQuantity};this.$http.post("/mobile/bite/addNewBite",o).then((function(o){o.data.success&&(e.$u.toast(o.data.msg),t.navigateBack())}))}}};e.default=o}).call(this,o("543d")["default"])},"0c0e":function(t,e,o){"use strict";(function(t){o("7736");n(o("66fd"));var e=n(o("84e6"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},"3b9b":function(t,e,o){"use strict";o.r(e);var n=o("0850"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},"84e6":function(t,e,o){"use strict";o.r(e);var n=o("b099"),i=o("3b9b");for(var a in i)"default"!==a&&function(t){o.d(e,t,(function(){return i[t]}))}(a);var s,d=o("f0c5"),u=Object(d["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=u.exports},b099:function(t,e,o){"use strict";var n={uSearch:function(){return o.e("uview-ui/components/u-search/u-search").then(o.bind(null,"2e64"))},uAvatar:function(){return o.e("uview-ui/components/u-avatar/u-avatar").then(o.bind(null,"7681"))},uIcon:function(){return o.e("uview-ui/components/u-icon/u-icon").then(o.bind(null,"513c"))},uLine:function(){return o.e("uview-ui/components/u-line/u-line").then(o.bind(null,"f0e5"))},uEmpty:function(){return o.e("uview-ui/components/u-empty/u-empty").then(o.bind(null,"8f6d"))},uPopup:function(){return o.e("uview-ui/components/u-popup/u-popup").then(o.bind(null,"dfc0"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,Math.round(t.heatQuantity/100*t.foodNum));t._isMounted||(t.e0=function(e){t.keyword=""},t.e1=function(e){t.showPopup=!1}),t.$mp.data=Object.assign({},{$root:{g0:o}})},a=[];o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}))}},[["0c0e","common/runtime","common/vendor"]]]);