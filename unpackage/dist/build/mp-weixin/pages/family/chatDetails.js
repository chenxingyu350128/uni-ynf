require('common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/family/chatDetails"],{"36be":function(e,t,n){},"3dc6":function(e,t,n){"use strict";var s=n("36be"),o=n.n(s);o.a},5483:function(e,t,n){"use strict";(function(e){n("7736");s(n("66fd"));var t=s(n("b0e7"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"78e7":function(e,t,n){"use strict";var s={uAvatar:function(){return n.e("uview-ui/components/u-avatar/u-avatar").then(n.bind(null,"7681"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"250b"))},uIcon:function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"513c"))},uBadge:function(){return n.e("uview-ui/components/u-badge/u-badge").then(n.bind(null,"6790"))}},o=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s}))},"82ac":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=e.getRecorderManager(),s=e.createInnerAudioContext(),o={data:function(){return{memberId:"",realName:"",type:"",list:[],processing:!1,isCancel:!1,notChanged:!0,startY:"",endY:"",duration:"",startTime:"",endTime:""}},computed:{sessionId:function(){return this.$store.state.app.sessionId},scope_record:function(){return this.$store.state.app.scope_record}},onLoad:function(t){var n=this;t.memberId&&(this.memberId=t.memberId),t.realName&&(this.realName=t.realName),t.type&&(this.type=parseInt(t.type)),this.scope_record||e.authorize({scope:"scope.record",success:function(t){console.log(t),"authorize:ok"===t.errMsg?n.$store.commit("SET_SINGLE_ITEM",["scope_record",!0]):e.navigateBack()}})},onShow:function(){e.setNavigationBarTitle({title:1===this.type?"和"+this.realName+"聊天中...":this.realName}),this.init()},methods:{init:function(){var e=this,t={sessionId:this.sessionId,memberId:this.memberId};this.$http.get("/mobile/user/getMemberMessages",t).then((function(t){t.data.success&&(e.list=t.data.obj,e.list.reverse())}))},startRec:function(e){console.log(e);console.log("start"),this.isCancel=!1,this.startY=e.changedTouches[0].clientY,this.processing=!0,n.start({format:"mp3"})},onTouch:function(e){this.endY=e.changedTouches[0].clientY,console.log("ing");var t=this.endY<this.startY&&this.startY-this.endY>50;this.notChanged=!t,this.isCancel=t},finishIt:function(t){if(this.notChanged=!0,this.processing=!1,this.endTime=Date.now(),n.stop(),this.isCancel)return!1;var o=this;n.onStop((function(t){console.log("recorder stop"+JSON.stringify(t)),o.duration=Number(t.duration/1e3).toFixed(1);var n=t.tempFilePath;s.src=n,s.play(),console.log(n);var i={sessionId:o.sessionId,memberId:o.memberId,length:o.duration,messageType:parseInt(o.type)};e.uploadFile({url:"https://www.yinaf.net/mobile/user/sendMessage",fileType:"audio",filePath:n,name:"file",formData:i,success:function(e){console.log(e)},fail:function(e){console.log(e)}})}))},playAudio:function(e){var t=this;console.log(e.voice_url),s.src=e.voice_url,s.play(),s.onError((function(e){t.$u.toast(e.errMsg),console.log(e)})),0===e.read_status&&this.setStatus(e)},setStatus:function(e){var t=this,n={sessionId:this.sessionId,mId:item.m_id};this.$http.post("/mobile/user/setMessagesRecord",n).then((function(e){e.data.success&&t.init()}))}}};t.default=o}).call(this,n("543d")["default"])},b0e7:function(e,t,n){"use strict";n.r(t);var s=n("78e7"),o=n("fe8b");for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("3dc6");var r,a=n("f0c5"),u=Object(a["a"])(o["default"],s["b"],s["c"],!1,null,"fadc7c4e",null,!1,s["a"],r);t["default"]=u.exports},fe8b:function(e,t,n){"use strict";n.r(t);var s=n("82ac"),o=n.n(s);for(var i in s)"default"!==i&&function(e){n.d(t,e,(function(){return s[e]}))}(i);t["default"]=o.a}},[["5483","common/runtime","common/vendor"]]]);